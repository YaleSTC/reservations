<% title "Catalog" %>
<!--show quicksearch box-->

<!-- Commented out quicksearch for now until we replace it with a better search functionality - mnquintana -->
<%# render :partial => 'quicksearch' %>

<% if @equipment_models_by_category.empty? %>
  <p>Sorry, no equipment models were found.</p>
<% else %>
  <%= paginate @paginated_equipment_models_by_category, :theme => "twitter-bootstrap" %>
  <%= form_tag update_user_per_cat_page_path, :class => "form-inline", :remote => true do %>
    <%= label_tag "Items per page:" %>
    <%= select_tag :user_cat_items_per_page, options_for_select(@user_per_page_opts, session[:user_per_cat_page]), :class => 'span1 autosubmitme' %>
  <% end %>
  <% @equipment_models_by_category.each do |category, equipment_models| %>
    <h2 class="catalog">
      <!--print category name-->
      <%= link_to category.name, category_equipment_models_path(category) %>
    </h2>    
    <ul class="catalog">
    <% unless equipment_models.nil? %>
      <% equipment_models.each do |equipment_model| %>
        <li>
          <!--show equipment model image-->
          <%= (link_to (image_tag equipment_model.photos.first.data.url(:small),
                        :class => 'product_small'),
                       equipment_model, :target => '_blank') unless equipment_model.photos.empty? %>
          <h3>
            <!--print equipment model name-->
            <%= link_to equipment_model.name, equipment_model %>
          </h3>
          <!--print number of equipment objects available-->
          (<%= equipment_model.available?(cart.start_date..cart.due_date) || "0" %>
           available from
           <%= cart.start_date.strftime("%b %d, %Y") %> to <%= cart.due_date.strftime("%b %d, %Y") %>)
          <br>
          <% if equipment_model.available?(cart.start_date..cart.due_date) %>
          <!--print add to cart link-->
            <%= link_to "Add to Cart", {:url => add_to_cart_path(equipment_model)},
                        :href => add_to_cart_path(equipment_model), :remote => true, :class => "btn" %>
            <% # (Using both the ":url" and ":href" symbols seems redundant. Remove one?) %>
          <% else %>
            <%= button_tag "Add to Cart", :class => "btn disabled" %>
          <% end %>
          <br>
          <br>
        </li>
      <% end %>
    <% end %>
    </ul>
  <% end %>
  <%= paginate @paginated_equipment_models_by_category, :theme => "twitter-bootstrap" %>
<% end %>
